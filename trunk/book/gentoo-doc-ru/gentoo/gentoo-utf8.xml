<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbookxi.rng" type="xml"?>
<article xmlns="http://docbook.org/ns/docbook"
        xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
<info><title>Использование UTF-8 в Gentoo</title></info>
<para/>
<para>Ссылка на оригинал: <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.gentoo.org/doc/ru/kde-config.xml">http://www.gentoo.org/doc/ru/utf-8.xml</link>
</para>
<para>С версии: 1.0</para><section><info><title>1. Предупреждение или Напутствие переводчика</title></info>
<para/>
<para>Путь Юникода в русском Gentoo-сообществе сложен. Мы постоянно сталкивались с проблемами неполной поддержки или же неподдержки вовсе отдельными приложениями стандарта UTF-8. </para>
<para/>
<para>Но всё меняется к лучшему. Большинство приложений так или иначе стало поддерживать региональные настройки UTF-8. А для не поддерживающих уже разработаны способы исправления этого недостатка. Но всё же, если у вас возникли трудности с настройкой Юникода в Gentoo, то вы всегда найдете помощь и поддержку (иногда сквозь стиснутые зубы :)) на следующих страницах: </para>
<para/>
<orderedlist>
<listitem>
<para>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ru.gentoo-wiki.com/HOWTO_ru_RU.utf8_Gentoo_way">Статья в gentoo-wiki о поддержке Юникода</link>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://gentoo.ru/forum"> </link>
</para>
</listitem>
<listitem>
<para>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://gentoo.ru/forum">Форум русского сообщества Gentoo</link> </para>
</listitem>
<listitem>
<para>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://forums.gentoo.org/viewforum-f-43.html">Русскоязычный форум на официальном сайте Gentoo</link> </para>
</listitem>
</orderedlist>
<para/>
<para>Если вы заметили неточность или хотите дополнить данное руководство, пожалуйста свяжитесь переводчиком или одним из редакторов перевода. </para>
<para/></section><section><info><title>2. Кодировки</title></info>
<para>Что такое кодировка?</para>
<para/>
<para>Компьютеры неспособны воспринимать текст. Вместо этого они каждый символ представляют как число. Традиционно каждый набор чисел, соответствующий алфавиту и символам (известный как кодировка или набор символов), ограничен в размере в силу ограничений оборудования. </para>
<para/>
<para>История кодировок символов</para>
<para/>
<para>Самой распространенной (или наиболее принятой повсеместно) кодировкой является ASCII (Американский стандартный код для обмена информацией, American Standard Code for Information Interchange). Повсеместное использование говорит о том, что ASCII — наиболее успешный программный стандарт современности. Нынешний ASCII стандартизован в 1986 году (ANSI X3.4, RFC 20, ISO/IEC 646:1991, ECMA-6) Американским национальным институтом по стандартизации (American National Standards Institute, ANSI). </para>
<para/>
<para>ASCII является строго семибитной кодировкой, из чего следует, что она использует семь двоичных цифр, то есть интервал от 0 до 127. ASCII начинается с 32 невидимых управляющих символов (с кодами от 0 до 31) и заканчивается управляющим символом DEL (или delete) с кодом 127. Символы в диапазоне от 32 до 126 видимы — это пробел, знаки препинания, латинские буквы и цифры. </para>
<para/>
<para>Восьмой бит в ASCII изначально использовался как бит целостности для проверки ошибок при передаче информации. Если не указывалось особо, он всегда равнялся 0. Это означает, что в ASCII каждый символ равняется одному байту. </para>
<para/>
<para>Хотя ASCII было достаточно для передачи информации на английском, для других европейских языков, содержащих символы с ударениями, это было не так просто. Для них был разработаны стандарты семейства ISO 8859. Они были обратно совместимы с ASCII, но также использовали восьмой бит для дополнения таблицы дополнительными 127 символами для каждой кодировки. Ограничения ISO 8859 были незначительными, поэтому стандарт получил распространение. На данный момент существует 15 вариантов стандарта ISO 8859 (от 8859-1 до 8859-15). Однако для каждого символа вне ASCII-совместимого диапазона между этими стандартами возникал конфликт. Чтобы еще больше усилить конфликт между различными кодировками, для восточноевропейских языков корпорацией Microsoft был введен набор Windows-1252, использованный в ранних версиях Windows. Этот набор является надстройкой ISO 8859-1, обладающий собственными изменениями. Однако все же эти наборы были совместимы с ASCII. </para>
<para/>
<para>Необходимость разработки совершенно отличных от ASCII однобайтовых кодировок для нелатинских алфавитов, как например EUC (Extended Unix Coding), используемый в японском и корейском (и в меньшей степени китайском) алфавитах, породила еще большую неразбериху с кодировками, из-за чего ряд операционных систем все еще использует различные наборы символов для одного и того же языка, например японские Shift-JIS и ISO-2022-JP. А пользователи, желающие видеть кириллицу, вынуждены были выбирать между KOI8-R (для русского и болгарского языков) и KOI8-U (для украинского языка), неудачной ISO 8859-5 и популярной Windows-1251. Все три семейства кодировок не полностью совместимы с ASCII (хотя в KOI8 фонетически созвучные кириллические символы расположены так же, как и латинские, благодаря чему даже при отбрасывании восьмого бита текст оставался читабельным в ASCII-терминалах в виде транслита). </para>
<para/>
<para>Все это привело к путанице и полной невозможности многоязычного общения, в особенности с использованием различных алфавитов. Переходим к Юникоду. </para>
<para/>
<para>Что такое Юникод?</para>
<para/>
<para>Юникод отбрасывает лимит традиционных однобайтовых кодировок. Он использует 17 «плоскостей», содержащих по 65 536 кодов символов. Таким образом, максимальное возможное число символов равно 1 114 112. Поскольку в первой плоскости («Basic Multilingual Plane» или BMP) содержится почти всё, что вам может понадобиться, многие ошибочно посчитали, что Юникод — это 16-битный набор символов. </para>
<para/>
<para>Юникод реализован несколькими способами, но распространены только два — UTF (Unicode Transformation Format) и UCS (Universal Character Set). Число после UTF обозначает число бит на каждый символ, когда как число после UCS обозначает число байт. UTF-8 стала наиболее распространенной при обмене текста Юникод из-за малых (сравнительно) потерь при хранении текста, Поэтому она и является основной темой данного документа. </para>
<para/>
<para>UTF-8</para>
<para/>
<para>UTF-8 — это кодировка переменной длины. Это означает, что для каждого символа она может использовать от одного до четырех байт. Первый байт UTF-8 используется для кодирования ASCII, благодаря чему UTF-8 полностью обратно совместима с ASCII. UTF-8 подразумевает, что ASCII и латинские символы равнозначны с небольшим увеличением размера данных, так как используется только первый байт. Пользователи восточных кодировок (например, японского), которым назначены старшие диапазоны, не так рады, так как в результате их данные разбухают на 50 %. </para>
<para/>
<para>Что UTF-8 может сделать для вас</para>
<para/>
<para>UTF-8 позволяет вам работать в совместимой со всеобщими стандартами и принятой по всему миру многоязычной среде, правда с небольшими потерями при обработке данных. UTF-8 — это наилучший способ для передачи не-ASCII символов через интернет, будь то электронная почта, IRC-сети или что-нибудь еще. Несмотря на это, множество людей расценивают использование UTF-8 при передаче данных неприличным и неуважительным. Всегда следует выяснять, поддерживает ли определенный канал, группа Usenet или список рассылки UTF-8 перед тем, как использовать символы из не-ASCII диапазона UTF-8. </para>
<para/></section><section><info><title>3. Включение UTF-8 в Gentoo Linux</title></info>
<para/>
<para>Поиск или создание локалей UTF-8</para>
<para/>
<para>Теперь, когда вы поняли основы Юникода, вы готовы начать использование UTF-8 в вашей системе. </para>
<para/>
<para>Главным требованием для UTF-8 является наличие установленной библиотеки glibc с поддержкой национального языка. При этом рекомендуется использовать файл /etc/locale.gen. Описание использования этого файла, однако, выходит за рамки данного документа. Его использование описано в Руководстве по локализации Gentoo. </para>
<para/>
<para>Далее, нужно определить, доступна ли нам локаль UTF-8 для нашего языка или придётся её создать. </para>
<para/>
<para>Листинг 3.1: Поиск существующей локали UTF-8</para>
<para>(Замените "ru_RU" своим регионом)</para>
<para># locale -a | grep 'ru_RU'</para>
<para>ru_RU</para>
<para>ru_RU.UTF-8</para>
<para/>
<para/>
<para>На выходе этой команды мы должны получить хотя бы одну строку, содержащую суффикс .UTF-8. Если таковых нет, то нам придётся создать локаль, совместимую с UTF-8. </para>
<para>Примечание: Запускайте следующую команду, если у вас нет UTF-8 локали для вашего языка. </para>
<para/>
<para/>
<para>Листинг 3.2: Создание локали UTF-8</para>
<para>(Замените "ru_RU" своим регионом)</para>
<para># localedef -i ru_RU -f UTF-8 ru_RU.UTF-8</para>
<para/>
<para/>
<para>Другим способом включить локаль UTF-8 является добавление её в файл /etc/locale.gen и генерация нужных локалей командой locale-gen. </para>
<para/>
<para>Листинг 3.3: Одна из строк в /etc/locale.gen</para>
<para>ru_RU.UTF-8/UTF-8</para>
<para/>
<para/>
<para>Настройка локали</para>
<para/>
<para>Есть одна переменная среды, которую необходимо установить, чтобы использовать UTF-8 локали: LANG (эту переменную также можно перезаписывать переменной LC_ALL). Есть множество способов сделать это. Некоторые люди предпочитают использовать UTF-8 только для определенного пользователя, поэтому они устанавливают эту переменную в своём ~/.profile (если используется /bin/sh), ~/.bash_profile или ~/.bashrc (если используется /bin/bash). </para>
<para/>
<para>Другие предпочитают установить локаль глобально. Есть по крайней один весомый аргумент в пользу этого подхода — при использовании /etc/init.d/xdm, так как сценарии инициализации запускают диспетчер окон до того, как будут загружены конфигурационные файлы командной оболочки. </para>
<para/>
<para>При установке глобальной локали должен быть использован файл /etc/env.d/02locale. Он должен выглядеть следующим образом: </para>
<para/>
<para>Листинг 3.4: Вид /etc/env.d/02locale</para>
<para>(Как и всегда, замените "ru_RU.UTF-8" вашей локалью)</para>
<para>LANG="ru_RU.UTF-8"</para>
<para/>
<para>Примечание: Вы можете также указывать LC_ALL вместо LANG. Так локаль устанавливается для всех категорий, включая числовые и денежные значения. На небольшом количестве систем это может вызывать некоторые проблемы. Однако, большинство пользователей может использовать LC_ALL без проблем. За дополнительными сведениями о категориях, затронутых использованием LC_ALL, пожалуйста, обращайтесь к странице локалей GNU. </para>
<para/>
<para/>
<para>Далее следует обновить среду. </para>
<para/>
<para>Листинг 3.5: Обновление среды</para>
<para># env-update</para>
<para>&gt;&gt;&gt; Regenerating /etc/ld.so.cache...</para>
<para> * Caching service dependencies ...</para>
<para># source /etc/profile</para>
<para/>
<para/>
<para>Теперь запустите locale без аргументов, чтобы увидеть, что у вас верные переменные среды: </para>
<para/>
<para/>
<para/>
<para/>
<para>Листинг 3.6: Проверка новой применённой локали</para>
<para># locale</para>
<para>LANG=</para>
<para>LC_CTYPE="ru_RU.UTF-8"</para>
<para>LC_NUMERIC="ru_RU.UTF-8"</para>
<para>LC_TIME="ru_RU.UTF-8"</para>
<para>LC_COLLATE="ru_RU.UTF-8"</para>
<para>LC_MONETARY="ru_RU.UTF-8"</para>
<para>LC_MESSAGES="ru_RU.UTF-8"</para>
<para>LC_PAPER="ru_RU.UTF-8"</para>
<para>LC_NAME="ru_RU.UTF-8"</para>
<para>LC_ADDRESS="ru_RU.UTF-8"</para>
<para>LC_TELEPHONE="ru_RU.UTF-8"</para>
<para>LC_MEASUREMENT="ru_RU.UTF-8"</para>
<para>LC_IDENTIFICATION="ru_RU.UTF-8"</para>
<para>LC_ALL=ru_RU.UTF-8</para>
<para/>
<para/>
<para>Вот и всё. Теперь вы используете локаль UTF-8, и следующим этапом является настройка повседневно используемых вами приложений. </para>
<para/></section><section><info><title>4. Поддержка приложениями</title></info>
<para/>
<para>Пока Юникод делает первые шаги в мире программного обеспечения, и многобайтовые кодировки еще не включены в языки программирования, наподобие C, и множество повседневно используемых программ. Даже сейчас некоторые программы не способны работать с UTF-8 как надо. К счастью, таких не так много! </para>
<para/>
<para>Имена файлов, NTFS и FAT</para>
<para/>
<para>В в конфигурационном меню ядра Linux есть множество параметров NLS, но главное — не паниковать! В большинстве случаев всё, что вам нужно — включить поддержку UTF-8 NLS в ваше ядро и изменить NLS по умолчанию на utf8. </para>
<para/>
<para>Листинг 4.1: Конфигурация ядра для UTF-8 NLS</para>
<para>File Systems --&gt;</para>
<para>  Native Language Support --&gt;</para>
<para>    (utf8) Default NLS Option</para>
<para>    &lt;*&gt; NLS UTF8</para>
<para>    (также &lt;*&gt; для других кодировок, используемых в ФС FAT или Joilet CD-ROM)</para>
<para/>
<para/>
<para>Если вы планируете монтировать разделы NTFS, то вам понадобиться указать параметр при монтировании nls=. Если вы будете монтировать разделы FAT, вам понадобится указать при монтировании параметр codepage=. Также вы можете установить для FAT кодовую страницу по умолчанию при конфигурации ядра. Помните, что параметр codepage, указываемый при монтировании, будет иметь приоритет над настройками ядра. </para>
<para/>
<para>Листинг 4.2: Настройки FAT при конфигурировании ядра</para>
<para>File Systems --&gt;</para>
<para>  DOS/FAT/NT Filesystems  --&gt;</para>
<para>    (866) Default codepage for fat</para>
<para/>
<para/>
<para>Не устанавливайте Default iocharset for fat в UTF-8, так как это не рекомендуется. Вместо этого укажите параметр utf8=true при монтировании раздела FAT. Для более детальной информации, смотрите man mount и документацию по ядру /usr/src/linux/Documentation/filesystems/vfat.txt. </para>
<para/>
<para>Чтобы сменить кодировку имен файлов, используйте app-text/convmv. </para>
<para/>
<para>Листинг 4.3: Пример использования convmv</para>
<para># emerge --ask app-text/convmv</para>
<para>(Формат команды)</para>
<para># convmv -f &lt;current-encoding&gt; -t utf-8 &lt;filename&gt;</para>
<para>(Замените koi8-r кодировкой, с которой хотите конвертировать)</para>
<para># convmv -f koi8-r -t utf-8 filename</para>
<para/>
<para/>
<para>Для изменения содержимого файлов, используйте утилиту iconv, поставляемую вместе с glibc: </para>
<para/>
<para>Листинг 4.4: Пример использования iconv</para>
<para>(Замените koi8-r кодировкой, с которой хотите конвертировать)</para>
<para>(Проверка верности вывода)</para>
<para># iconv -f koi8-r -t utf-8 filename</para>
<para>(Конвертация файла, вы должны указать другое имя файла)</para>
<para># iconv -f koi8-r -t utf-8 filename &gt; newfile</para>
<para/>
<para/>
<para>Также для этой цели может быть использована утилита app-text/recode. </para>
<para/>
<para>Системная консоль</para>
<para/>
<para>Важно: Вам необходим &gt;=sys-apps/baselayout-1.11.9 для поддержки Юникода в консоли. </para>
<para/>
<para>Для включения UTF-8 в консоли вы должны отредактировать /etc/rc.conf и установить переменную UNICODE="yes". Также прочтите комментарии в этом файле — важно, чтобы в системе были шрифты с нужным диапазоном символов (если вы хотите выжать из Юникода всё). </para>
<para/>
<para>В файле /etc/conf.d/keymaps переменной KEYMAP должна соответствовать раскладка Unicode. </para>
<para/>
<para>Листинг 4.5: Пример файла /etc/conf.d/keymaps</para>
<para>(Замените "ru4" на вашу любимую раскладку)</para>
<para>(Для русского языка нужен ключ -u — прим. переводчика)</para>
<para>KEYMAP="-u ru4"</para>
<para>(Подмена кодировки для русского языка — прим. переводчика)</para>
<para>DUMPKEYS_CHARSET="koi8-r"</para>
<para/>
<para>Важно: Помните, что для правильного отображения вам понадобятся шрифты с поддержкой Юникода. Подробнее смотрите раздел X11 и шрифты этого руководства. </para>
<para/>
<para>А теперь выберем подходящий шрифт, поддерживающий Юникод. </para>
<para/>
<para>Листинг 4.6: Файл /etc/conf.d/consolefont</para>
<para>(Отредактируйте переменную CONSOLEFONT)</para>
<para>CONSOLEFONT="ter-k14n" # шрифт из пакета terminus-font)</para>
<para/>
<para/>
<para>ncurses и slang</para>
<para/>
<para>Примечание: Если вы не устанавливали или не использует slang, не принимайте во внимание упоминания о нём в этом разделе. </para>
<para/>
<para/>
<para>Будет хорошим решением добавить unicode к глобальным USE-флагам в файле /etc/make.conf, а затем при необходимости пересобрать sys-libs/ncurses и sys-libs/slang. Portage это сделает автоматически при обновлении системы: </para>
<para/>
<para>Листинг 4.7: Обновление системы</para>
<para># emerge --update --deep --newuse world</para>
<para/>
<para/>
<para>Также понадобится пересобрать пакеты, зависящие от них, раз изменения USE вступили в силу. Используемая утилита (revdep-rebuild) входит в пакет gentoolkit. </para>
<para/>
<para>Листинг 4.8: Пересборка программ, скомпонованных с ncurses или slang</para>
<para># revdep-rebuild --soname libncurses.so.5</para>
<para># revdep-rebuild --soname libslang.so.1</para>
<para/>
<para/>
<para>KDE, GNOME и Xfce</para>
<para/>
<para>Все основные графические оболочки полностью совместимы с Юникодом и не требуют дополнительной настройки, кроме той, что описана в этом документе. Все это благодаря тому, графические библиотеки (Qt и GTK+2) совместимы с UTF-8. Следовательно, все приложения, работающие на основе этих библиотек, также должны поддерживать UTF-8 без дополнительных настроек. </para>
<para/>
<para>Исключением в этом правиле является Xlib и GTK+1. GTK+1 требует iso-10646-1 FontSpec в ~/.gtkrc, например -misc-fixed-*-*-*-*-*-*-*-*-*-*-iso10646-1. Также приложения, использующие Xlib или Xaw, нуждаются в подобной FontSpec, иначе они не буду работать. </para>
<para>Примечание: Если у вас установлен Центр управления gnome1, используйте его. Воспользуйтесь любым из шрифтов семейства iso10646-1. </para>
<para/>
<para/>
<para>Листинг 4.9: Пример ~/.gtkrc (для GTK+1), определяющий Юникод-совместимый шрифт</para>
<para>style "user-font"</para>
<para>{</para>
<para>    fontset="-misc-fixed-*-*-*-*-*-*-*-*-*-*-iso10646-1"</para>
<para>}</para>
<para>widget_class "*" style "user-font"</para>
<para/>
<para>Важно: В Xorg 6.8.2 для славянских языков эта проблема подобным образом не решается. Обратитесь к руководствам на сайтах Fantoo или Gentoo-wiki для решения данной проблемы либо откатите Xorg до версии 6.8.0. </para>
<para/>
<para/>
<para>Если приложение одинаково поддерживает Qt и GTK+2, то обычно GTK+2 GUI выдает лучшие результаты при работе с Юникодом. </para>
<para/>
<para>X11 и шрифты</para>
<para>Важно: По сравнению с XFree86 x11-base/xorg-x11 лучше поддерживает Юникод, и поэтому настоятельно рекомендуется использовать именно его. </para>
<para/>
<para>Шрифты TrueType обычно совместимы с Юникодом, и большинство шрифтов, поставляемых с Xorg, имеют великолепную поддержку кодировок, хотя не все глифы Юникода могут быть отображены для конкретного шрифта. Чтобы собрать шрифты с поддержкой Восточноазиатских алфавитов (включающие набор Bitstream Vera) для X-сервера, добавьте USE-флаг cjk. Много приложений используют этот флаг, поэтому неплохо бы внести его как постоянный флаг. </para>
<para/>
<para>Также несколько пакетов шрифтов в Portage совместимы с Юникодом. </para>
<para/>
<para>Листинг 4.10: Необязательно: установка некоторых Юникод-совместимых шрифтов</para>
<para># emerge terminus-font intlfonts freefonts cronyx-fonts corefonts</para>
<para/>
<para/>
<para>Диспетчеры окон и терминальные эмуляторы</para>
<para/>
<para>Диспетчеры окон, не использующие GTK или Qt, обычно очень хорошо поддерживают Юникод, так как чаще всего для отображения шрифтов используют библиотеку Xft. Если ваш диспетчер окон не использует Xft, то вы все еще можете использовать FontSpec, указанный в предыдущем разделе в качестве шрифта Юникода. </para>
<para/>
<para>Эмуляторы терминала, использующие Xft, в большинстве случаев поддерживают Юникод. Кроме Konsole и gnome-terminal, лучшим выбором в Portage будет x11-terms/rxvt-unicode, xfce-extra/terminal, gnustep-apps/terminal, x11-terms/mlterm или чистый x11-terms/xterm, собранный с USE-флагом unicode и запускаемый как uxterm. app-misc/screen тоже поддерживает UTF-8, если запускается с параметром screen -U, или внесите следующее в файл ~/.screenrc: </para>
<para/>
<para>Листинг 4.11: ~/.screenrc с UTF-8</para>
<para>defutf8 on</para>
<para/>
<para/>
<para>Vim, Emacs, Xemacs и Nano</para>
<para/>
<para>Vim полностью поддерживает UTF-8 и к тому же автоматически определяет файлы с UTF-8. Для более детальной информации используйте в Vim :help mbyte.txt. </para>
<para/>
<para>Emacs 22.x и выше полностью поддерживает UTF-8. Xemacs 22.x ещё не поддерживает различные кодировки. </para>
<para/>
<para>Более старшим версиям Emacs и/или Xemacs понадобятся пакеты app-emacs/mule-ucs и/или app-xemacs/mule-ucs и добавление следующих строчек в файл ~/.emacs для поддержки CJK-языков в UTF-8: </para>
<para/>
<para>Листинг 4.12: Emacs с поддержкой CJK UTF-8</para>
<para>(require 'un-define)</para>
<para>(require 'jisx0213)</para>
<para>(set-language-environment "Japanese")</para>
<para>(set-default-coding-systems 'utf-8)</para>
<para>(set-terminal-coding-system 'utf-8)</para>
<para/>
<para/>
<para>Nano полностью поддерживает UTF-8 начиная с версии 1.3.6. </para>
<para/>
<para>Командные оболочки</para>
<para/>
<para>На данный момент только bash полностью поддерживает Юникод через библиотеку GNU readline. Пользователи оболочки Z находятся в промежуточном положении — пока ни одна из составных оболочки еще поддерживает Юникод, хотя на данный момент ведутся усиленные работы для поддержки многобайтовых кодировок. </para>
<para/>
<para>Оболочки C, tcsh и ksh не поддерживают UTF-8. </para>
<para/>
<para>Irssi</para>
<para/>
<para>Irssi полностью поддерживает UTF-8, хотя для этого требуется дополнительная настройка пользователем. </para>
<para/>
<para>Листинг 4.13: Включение UTF-8 в Irssi</para>
<para>/set term_charset UTF-8</para>
<para/>
<para/>
<para>Для каналов, где не-ASCII символы чаще всего передаются в не-UTF-8 кодировках, может пригодиться команда /recode для перекодировки символов. Наберите /help recode для большей информации. </para>
<para/>
<para>Mutt</para>
<para/>
<para>Почтовый агент Mutt очень хорошо справляется с Юникодом. Чтобы использовать UTF-8 для Mutt, вам нет необходимости что-либо добавлять в конфигурационные файлы. Mutt будет работать с Юникодом без модификации, при условии, что все ваши конфигурационные файлы (включая подпись) сохранены в UTF-8. </para>
<para>Примечание: Вы всё ещё можете видеть знаки вопроса при чтении почты с помощью Mutt. Это случается из-за того, что некоторые люди используют почтовые клиенты, не устанавливающие используемую кодировку письма. Вы ничего больше не можете сделать, кроме как попросить их правильно настроить свои клиенты. </para>
<para/>
<para/>
<para>См.<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://wiki.mutt.org/index.cgi?MuttFaq/Charset">Mutt Wiki </link>для большей информации. </para>
<para/>
<para>Man</para>
<para/>
<para>Man-страницы являются неотъемлемой частью любой системы Linux. Чтобы удостовериться, что все страницы отображаются верно, отредактируйте /etc/man.conf и замените следующую строку. </para>
<para/>
<para>Листинг 4.14: Изменения man.conf для поддержки Юникода</para>
<para>(Это старая строка)</para>
<para>NROFF           /usr/bin/nroff -Tascii -c -mandoc</para>
<para>(Замените ее этой)</para>
<para>NROFF           /usr/bin/nroff -mandoc -c</para>
<para/>
<para/>
<para>elinks и links</para>
<para/>
<para>Это самые популярные текстовые браузеры, и вы узнаете, как установить поддержку UTF-8 для них. В elinks и links есть два способа сделать это — через меню Setup (Установки) браузера или отредактировав конфигурационный файл. Чтобы настроить параметры в самом браузере, откройте какой-нибудь сайт с помощью elinks или links и нажмите Alt+S. Вы попадете в меню настроек (Setup Menu), после чего выберите параметры терминала (Terminal options), или нажмите T. Пролистайте вниз и выберите последний параметр — UTF-8 I/O, нажав на Enter. После сохраните и выйдите из меню. В links вы можете сделать то же самое, нажав Alt+S, а затем S для сохранения. Пример конфигурационного файла показан ниже. </para>
<para/>
<para>Листинг 4.15: Включение UTF-8 в elinks/links</para>
<para>(Для elinks добавьте в /etc/elinks/elinks.conf или ~/.elinks/elinks.conf следующую строку)</para>
<para>set terminal.linux.utf_8_io = 1</para>
<para/>
<para>(Для links добавьте ~/.links/links.cfg следующую строку)</para>
<para>terminal "xterm" 0 1 0 us-ascii utf-8</para>
<para/>
<para/>
<para>Samba</para>
<para/>
<para>Samba — это набор программ, реализующих протокол SMB (Server Message Block) для UNIX-систем (Mac, Linux и FreeBSD). Этот протокол также иногда упоминается как Common Internet File System (CIFS). Samba содержит также систему NetBIOS, используемую для предоставления доступа к файлам в Windows-сетях. </para>
<para/>
<para>Листинг 4.16: Включение UTF-8 в Samba</para>
<para>(Отредактируйте /etc/samba/smb.conf и добавьте следующее в раздел [global])</para>
<para>dos charset = 866</para>
<para>unix charset = UTF-8</para>
<para>display charset = UTF-8</para>
<para/>
<para/>
<para>Проверка работоспособности</para>
<para/>
<para>Есть множество сайтов, проверяющих UTF-8. net-www/w3m, net-www/links, net-www/elinks, net-www/lynx, все браузеры, основанные на движке Mozilla (включая Firefox) поддерживают UTF-8. Konqueror и Opera тоже полностью поддерживают UTF-8. </para>
<para/>
<para>При использовании текстовых браузеров, удостоверьтесь, что используете совместимый с Юникодом терминал. </para>
<para/>
<para>Если вы видите символы, отображаемые как квадратики с буквами или цифрами внутри, то это значит, что в ваших шрифтах нет соответствующего глифа для символа. Вместо этого, они отображают квадрат с шестнадцатиричным кодом символа UTF-8. </para>
<para/>
<orderedlist>
<listitem>
<para>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.w3.org/2001/06/utf-8-test/UTF-8-demo.html">Тестовая страница W3C с UTF-8</link>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://titus.uni-frankfurt.de/indexe.htm?/unicode/unitest.htm"> </link>
</para>
</listitem>
<listitem>
<para>
<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://titus.uni-frankfurt.de/indexe.htm?/unicode/unitest.htm">Тестовая страница Франкфуртского университета</link> </para>
</listitem>
</orderedlist>
<para/>
<para/>
<para>Ввод символов</para>
<para/>
<para>Dead keys могут быть использованы для ввода символов, не отображенных на клавиатуре, в X-сервере. Для этого нужно, удерживая правый Alt (в некоторых странах он называется AltGr), нажать на дополнительную неалфавитную клавишу с символом, не являющимся буквой или цифрой (модификатор), а затем нажать на необходимую букву. Dead key изменит ее. Ввод может быть изменен также с помощью Shift при нажатых AltGr и модификаторе. </para>
<para/>
<para>Чтобы включить dead keys в X, нужно иметь раскладку, поддерживающую их. Большинство европейских раскладок уже имеют dead keys по умолчанию. Тем не менее, они не являются настоящими североамериканскими раскладками. Хотя существуют незначительные отличия между различными раскладками, простейшим решением будет использование раскладки «en_US» вместо просто «us». Раскладка указывается в /etc/X11/xorg.conf: </para>
<para/>
<para>Листинг 4.17: Пример раздела /etc/X11/xorg.conf</para>
<para>Section "InputDevice"</para>
<para>    Identifier "Keyboard0"</para>
<para>    Driver     "kbd"</para>
<para>    Option     "XkbLayout" "en_US" # Вместо просто "us"</para>
<para>    (Другие параметры Xkb)</para>
<para>EndSection</para>
<para/>
<para>Примечание: Эти изменения нужны только в том случае, если вы используете североамериканскую раскладку либо любую другую, в которой dead keys не работают. Европейским пользователям нет нужны что-либо менять. </para>
<para/>
<para/>
<para>Изменения вступят в силу только при перезагрузке X-сервера. Чтобы изменения вступили немедленно, используйте утилиту setxkbmap, например, setxkbmap en_US. </para>
<para/>
<para>Рассмотрим действия dead keys на примерах. Хотя результат зависит от текущей локали, сам принцип действия должен работать в нее зависимости от нее. Примеры содержат символы Юникода, так что убедитесь, что ваш браузер корректно отображает их. </para>
<para/>
<para>При нажатии единожды нажатых AltGr и [, а затем нажатой «a» мы получаем «a». При единожды нажатых AltGr и [, а затем нажатой «e», получаем «e». Нажав на AltGr и ;, мы получим «a», а нажав AltGr и ;, а затем на «e», получаем «e». </para>
<para/>
<para>Нажав на AltGr, Shift и [, отпустив их и нажав «a», мы получим скандинавскую «a». Также при нажатии AltGr, Shift и [, отпускании только [ и повторном ее нажатии мы получим только «?». Хотя этот символ (U+02DA) и похож на символ градуса (U+00B0), на самом деле он им не является. Подобным образом работают и другие модификаторы — нажатие AltGr and [, отпускание [ и повторное нажатие выводят «?». </para>
<para/>
<para>AltGr может быть использована вместе с одной из алфавитных клавиш. Например, комбинация AltGr и m выводит греческую строчную букву мю: «ч». AltGr и s выводит немецкий символ эсцет: «?». Множество европейцев захотят установить сочетание AltGr и 4 (или E в зависимости от клавиатурный таблицы), выводящее символ Евро, «?» (так как на их клавиатурах он нанесен). </para>
<para/></section>
</article>