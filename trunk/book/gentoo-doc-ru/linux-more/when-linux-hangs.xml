<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbookxi.rng" type="xml"?>
<article xmlns="http://docbook.org/ns/docbook"
        xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
<info><title>Что делать, если система «зависла»</title></info>
        <para>Ссылка на оригинал: <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://perlovka.homelinux.net/?node=gentoo_articles&amp;id=4">http://perlovka.homelinux.net/?node=gentoo_articles&amp;id=4</link>
        </para>
        <para>Автор: Perlovka</para>
        <para>С версии: 1.5</para>
        <para/>
        <para>«Подвесить» Линукс вполне реально, несмотря на стабильность системы. «Подвесить» взято в кавычки потому, что при кажущихся признаках капитального останова системы ядро продолжает работать.</para>
        <para>Рассмотрим некоторые ситуации, в которые может попасть пользователь:</para><section><info><title>1. «Завис» X сервер</title></info>
            <para>При зависании или неадекватном поведении X сервера, можно воспользоваться командой перезапуска сервера — Ctrl+Alt+Backspace. При этом, если сервер был запущен командой startx, вы вернетесь в приглашение консоли; если же он был запущен c помощью менеджера дисплея xdm (gdm,kdm), то вы окажетесь на экране вашего графического менеджера загрузки.</para></section><section><info><title>2. Приложение не воспринимает команды</title></info>
                <para>Если система перестала отвечать на команды клавиатуры, и Ctrl+Alt+Backspace не помогает, приходится использовать более жесткие методы воздействия. Один из этих методов заключается в использовании низкоуровневых сигналов ядра. Они реализуются с помощью клавиши SysRq (System Request), также известной как PrintScreen.</para>
                <para>Для использования этих сигналов вам может понадобиться пересобрать ядро с их поддержкой:</para>
                <para>Kernel hacking ---&gt;</para>
                <para>[*] Magic SysRq key</para>
                <para>Также можно включить эту опцию «на лету», но работать это будет до первой перезагрузки компьютера:</para>
                <para>echo "1" &gt; /proc/sys/kernel/sysrq</para>
                <para>Итак, вы можете использовать следующие комбинации клавиш в аварийной ситуации:</para>
                <para>Alt+SysRq+R — изменение режима клавиатуры с Raw в XLAT. Если приложение зависло, и заблокировало клавиатуру, не оставляя вам возможности перейти в консоль простым нажатием Ctrl+Alt+F1, воспользуйтесь этой комбинацией. Теперь вы сможете перейти в консоль и прервать выполнение приложения.</para>
                <para>Alt+SysRq+K — эта комбинация носит название Secure Access Key (SAK). Она убивает все запущенные в текущей виртуальной консоли процессы. Исторически SAK предназначался для других целей. Применять его советовали пользователям перед тем как залогиниться в систему. Дело в том, что довольно легко написать программу или скрипт, эмулирующие логин. Неискушенный пользователь вводит свой логин и пароль, а «троянский конь» сохраняет их в надежном месте, чтобы злоумышленник воспользовался плодами вашей доверчивости. Если же юзер перед тем как зайти в систему нажмет SAK, то прибьет трояна и получит нормальное, «оригинальное» приглашение системы.</para>
                <para>Alt+SysRq+E — посылает сигнал SIGTERM всем процессам, кроме init. Сигнал SIGTERM означает, что система завершает некий процесс и прибирает за ним мусор — закрывает открытые процессом файлы, убивает временные и так далее;</para>
                <para>Alt+SysRq+I — посылает сигнал SIGKILL всем процессам, кроме init. В отличие от предыдущего сигнала, SIGKILL грубо прерывает выполнение программы, не выполняя после этого «зачистку».</para>
                <para>Alt+SysRq+L — посылает сигнал SIGKILL всем процессам, включая init. В этом случае система уходит в полный даун. Эту команду лучше не трогать.</para>
                <para>Alt+SysRq+S — запускает аварийную синхронизацию (запись кэша) всех примонтированных дисков. Позволяет избежать потери данных.</para>
                <para>Alt+SysRq+U — Перемонтировать все примонтированные файловые системы в режиме «только для чтения». Если операция прошла успешно, fsck не будет проверять файловые системы после «жесткого» перезапуска системы.</para>
                <para>Alt+SysRq+B — перезагрузка системы. Очень быстрая, потому что этапы синхронизации и размонтирования пропускаются. Употреблять только в самых крайних случаях. С таким же успехом можете нажать на Reset.</para>
                <para>Alt+SysRq+O — действует на систему подобно выстрелу в висок. Никакой синхронизации буфера, размонтирования и прочего. Сразу гасится свет, то бишь вырубается питание. Поэтому до нажатия этих клавиш следует синхронизировать буфер (Alt+SysRq+S), затем перемонтировать файловые системы в режиме «только для чтения» (Alt+SysRq+U) и только потом — Alt+SysRq+O. И запомните — сначала синхронизация, потом размонтирование, однако не наоборот.</para>
                <para/></section>
</article>