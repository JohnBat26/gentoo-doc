<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbookxi.rng" type="xml"?>
<article xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
    <info>
        <title>HOWTO Соединение с Internet</title>
    </info>
    <para>    Ссылка на оригинал: <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ru.gentoo-wiki.com/HOWTO_Соединение_с_Internet">http://ru.gentoo-wiki.com/</link>
    </para>
    <para>C версии: 1.0</para>
    <para>Изменено: 1.3</para>
    <section>
        <title>Настройка VPN</title>
        <para>Это работает для ядер &gt;=2.6.15 </para>
        <section>
            <info>
                <title>Проверка параметров ядра </title>
            </info>
            <para>Если ваш провайдер использует mppe-mppc проверьте следующее: </para>
            <example>
                <title>Конфигурация ядра Linux: Параметры ядра </title>
                <screen>  Device Drivers --->
    Network support --->
      &lt;M>   PPP (point-to-point protocol) support
        &lt;M>   PPP MPPE compression (encryption) (EXPERIMENTAL)
 Cryptographic options ---> 
      &lt;M>   SHA1 and RC4 algorithms</screen>
            </example>
            <para>Теперь необходимо собрать наше ядро. Без разницы, как вы скомпилировали эти части. Вы можете вкомпилировать все в ядро или собрать модулями. В конце вы должны подгрузить модули: </para>
            <itemizedlist>
                <listitem>
                    <para>libcrc32c </para>
                </listitem>
                <listitem>
                    <para>ip_gre </para>
                </listitem>
                <listitem>
                    <para>crc_ccitt </para>
                </listitem>
                <listitem>
                    <para>ppp_async </para>
                </listitem>
                <listitem>
                    <para>и конечно ppp_mppe_mppc. </para>
                </listitem>
            </itemizedlist>
            <para>А затем запустите <command>modules-config</command>. </para>
        </section>
        <section>
            <info>
                <title>Установка пакетов </title>
            </info>
            <para>Это работает для ядер &gt;=2.6.15 </para>
            <para>Установка очень проста:</para>
            <screen><prompt>#</prompt> <userinput>emerge sys-kernel/gentoo-dev-sources ppp pptpclient</userinput></screen>
            <para>для ppp должны быть включены флаги pam,atp,dhcp (не достоверно, у меня работает без atp и dhcp)</para>
        </section>
        <section>
            <info>
                <title>Настройка клиента</title>
            </info>
            <para>Если все удалось, то теперь вам необходимо сконфигурировать клиента. Вот пример конфигурации <filename>/etc/ppp/peers/myvpn</filename>: </para>
            <programlisting>pty            "/usr/sbin/pptp <replaceable>xxx.xxx.xxx.xxx</replaceable> --nolaunchpppd" #xxx...это адрес сервера
name           myname
remotename     myvpn
lock
dump
noipx
#debug  #включите эту опцию,если хотите видеть отладочные сообщения(пригодиться если ничего не работает)
ipcp-accept-local
ipcp-accept-remote
lcp-echo-failure 4
lcp-echo-interval 30
asyncmap 0
crtscts
require-mppe
refuse-eap
nobsdcomp
nodeflate
proxyarp
ipparam myvpn</programlisting>
            <para>Осталось только дозвониться до провайдера: <command>pon myvpn</command>. Для вывода отладочных сообщений на этой же консоли введите: <command>pon myvpn debug dump logfd 2</command>.</para>
            <para>Теперь необходимо настроить таблицы маршрутизации. Обычно это делается так: <command>route add default dev ppp0</command>.</para>
        </section>
        <section>
            <info>
                <title>Настройка с помощью pptpconfig</title>
            </info>
            <para>Для графической (GTK+) настройки PPTP используйте </para>
            <itemizedlist>
                <listitem>
                    <para>net-dialup/pptpconfig </para>
                </listitem>
            </itemizedlist>
            <para>он пока под маской "~x86"</para>
            <example>
                <title>Установка pptpconfig</title>
                <programlisting><prompt>#</prompt> <userinput>ACCEPT_KEYWORDS="~x86" &amp;&amp; emerge pptpconfig</userinput></programlisting>
            </example>
            <para>Или более правильно в файл <filename>/etc/portage/package.keywords</filename> добавить следующие строки: </para>
            <programlisting>net-dialup/pptpconfig ~x86
dev-php4/php-gtk ~x86 </programlisting>
            <para>А затем</para>
            <example>
                <title>Установка pptpconfig</title>
                <screen><prompt>#</prompt> <userinput>emerge pptpconfig</userinput></screen>
            </example>
            <note>
                <para> Для нормальной сборки необходимы флаги <code>USE=cli pcntl pcre posix session</code>
                </para>
            </note>
            <para>Наберите от рута, например в xterm: <command>pptpconfig &amp;</command>
            </para>
            <para>Создайте новое соединение и настройте в соответствии с параметрами указаннымы выше, плюс поправка на рекомендации провайдера. </para>
            <para>Для настройки маршрутизации по умолчанию используется вкладка Routing, на ней используйте значение All to tunnel.Выберите созданное соединение и нажмите Start. Все :)</para>
            <note>
                <para>Примечание: если возникнут проблемы с соединением на вкладке "Miscellanyous" в опциях для pppd напишите </para>
                <programlisting>noipdefault 50</programlisting>
            </note>
        </section>
        <section>
            <info>
                <title>Проверяем соединение </title>
            </info>
            <para>Теперь все готово. Можно навестить <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ru.gentoo-wiki.com/">Gentoo-Wiki</link> ;) </para>
            <para>Проверить соединение можно командой:</para>
            <screen><prompt>#</prompt> <userinput>ifconfig ppp0</userinput>
ppp0  Link encap:Point-to-Point Protocol
      inet addr:xxx.xxx.xxx.xxx  P-t-P:xxx.xxx.xxx.xxx  Mask:xxx.xxx.xxx.xxx.xxx
      UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1500  Metric:1
      RX packets:6 errors:0 dropped:0 overruns:0 frame:0
      TX packets:6 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:3
      RX bytes:72 (72.0 b)  TX bytes:78 (78.0 b)</screen>
            <para>
                <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://pptpclient.sourceforge.net/howto-gentoo.phtml">Настройка VPN-соединения</link> для Gentoo </para>
            <para>
                <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://pptpclient.sourceforge.net/routing.phtml">Настройка маршрутизации</link> для VPN-соединений</para>
            <para>
                <note>
                    <para>(JohnBat26): Я использую perl скрипт: pptp-command для работы с VPN. Также можно воспользоваться Webmin. Взято с сайта провайдера <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://2com.net/">2Com:</link></para>
                    <screen>/usr/sbin/pptp-command <lineannotation>(появится после установки pptp-client)</lineannotation></screen>
                    <para>Надо запустить этот скрипт из под пользователя root.</para>
                    <para>Затем выбрать:</para>
                    <screen>Setup -> Manage CHAP secrets -> Add a New CHAP secret
Local Name: <replaceable>ВАШ_ЛОГИН</replaceable>
Remote Name [PPTP]: 2Com
Password: <replaceable>ВАШ_ПАРОЛЬ</replaceable></screen>
                    <para>Затем выбрать Quit</para>
                    <para>Затем выбрать:</para>
                    <screen>Add a NEW PPTP Tunnel -> Other
Tunnel Name: 2Com
Server IP: 192.168.<replaceable>X</replaceable>.2 <lineannotation>(здесь Х - номер вашей сети)</lineannotation>
route: add default ppp0
route:
Local Name: ВАШ_ЛОГИН
Remote Name [PPTP]: 2Com</screen>
                    <para>Затем выбрать Quit</para>
                    <para>ВНИМАНИЕ!!!!</para>
                    <para>Проверьте наличие файла <filename>/etc/ppp/options.pptp</filename>. Файл <filename>/etc/ppp/options.pptp</filename> должен выглядеть след. образом:</para>
                    <programlisting>lock
noauth
nobsdcomp
nodeflate
novj
novjccomp
nopcomp
noaccomp</programlisting>
                    <para>Для установки VPN соединения надо запустить скрипт <filename>/usr/sbin/pptp-command</filename>. Затем выбрать:</para>
                    <screen>start -&gt; 2Com</screen>
                    <para>Для разрыва VPN соединения надо запустить скрипт <filename>/usr/sbin/pptp-command</filename>. Затем выбрать:</para>
                    <screen>stop </screen>
                </note>
            </para>
        </section>
    </section>
    <section>
        <info>
            <title>Через pppoe</title>
        </info>
        <example>
            <title>Устанавливаем pppoe</title>
            <screen><prompt>#</prompt> <userinput>emerge pppoe</userinput></screen>
        </example>
        <para>В <filename>/etc/conf.d/net</filename> прописываем</para>
        <programlisting>modules=( "ifconfig" )
config_eth0=( "null" )
config_ppp0=( "ppp" )
link_ppp0="eth0"
plugins_ppp0=("pppoe")
username_ppp0='login'
password_ppp0='passwd'
pppd_ppp0=(
       "defaultroute"  # Make this PPP interface the default route
       "usepeerdns"    # Use the DNS settings provided by PPP
       "lcp-echo-interval 15"  # Send a LCP echo every 15 seconds
       "lcp-echo-failure 3"    # Make peer dead after 3 consective
       )
#Если собираемся раздавать интернет в локалку с помощью маскарадинга то нужно добавить такую строчку в IPTABLES:
#iptables -I FORWARD 1 -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu</programlisting>
        <example>
            <title>Делаем симлинк </title>
            <screen><prompt>#</prompt> <userinput>ln -s /etc/init.d/net.lo /etc/init.d/net.ppp0</userinput></screen>
        </example>
        <example>
            <title>Запускаем</title>
            <screen><prompt>#</prompt> <userinput>/etc/inet.d/net.ppp0 start </userinput></screen>
        </example>
    </section>
    <section>
        <info>
            <title>Настройка выхода через DIAL-UP</title>
        </info>
        <section>
            <info>
                <title>Подключение модема</title>
            </info>
            <section>
                <info>
                    <title>Последовательный порт</title>
                </info>
                <para>Подключение данного типа модема заключается в физическом "втыкании" в один из COM портов дата кабеля модема, включении модема в розетку и подсоединения к нему телефонной лини. Все это можно прочитать в руководстве к модему. Как извесно последовательные порты в Линукс именуются <filename>/dev/ttyS<replaceable>x</replaceable></filename> (где x - номер порта, <filename>/dev/ttyS0</filename> = COM1 и т.д.) Вам нужно будет знать имя порта на который Вы "повесили свой модем"...скорее всего у вас их два или даже один, поэтому ошибиться здесь довольно сложно. Либо <filename>/dev/ttyS0</filename>, либо <filename>/dev/ttyS1</filename>.</para>
                <para>На этом подключение модема к последовательному порту можно считаль законченым. </para>
            </section>
            <section>
                <info>
                    <title>Подключение через USB</title>
                </info>
                <example>
                    <title>Конфигурация ядра Linux: Установка пакетов</title>
                    <screen>   "USB support" >>
     &lt;*>"USB Modem (CDC ADCM)support"</screen>
                </example>
                <para>устройство будет называться <filename>/dev/ttyACM0</filename>.</para>
            </section>
            <section>
                <info>
                    <title>Win модемы</title>
                </info>
                <para>Для работы Win-модема нужно установить драйвер. Не все win-модемы поддерживаються поэтому Вам остается надеяться на лучшее. За драйверами идем на <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.linmodems.org/">http://www.linmodems.org/</link> Там можно взять отличную софтину под названием scanModem которая опросит Ваш модем и выдаст (или не выдаст) URL откуда взять драйвер. Тянем. Распаковываем. Читаем INSTALL. Ставим. Еще можно почитать эту статью: <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ru.gentoo-wiki.com/Linmodems">linmodems</link>
                </para>
            </section>
            <section>
                <info>
                    <title>Для всех типов модемов</title>
                </info>
                <para>Для удобства можно создать симлинк вида <filename>/dev/modem</filename> на соответствующее модему устройство: </para>
                <screen><prompt>#</prompt> <userinput>ln -s /dev/ttyS0 /dev/modem</userinput></screen>
                <para>и в дальшейшем в настройках использовать устройство (<filename>/dev/modem</filename>)... хотя никто и не запрещает использовать устройство модема без симлинка <filename>/dev/tyySx</filename>. </para>
            </section>
            <section>
                <info>
                    <title>Проверка работоспособности, возможные грабли</title>
                </info>
                <para>После подключения модема и установки всех необходимых драйверов необходимо проверить его работоспособность. Я делаю это так: запускаю утилиту minicom и даю команду AT. Если все в порядке, я в ответ получаю ОК, и не получаю если что-то не так. Если ОК не получен, то самое первое, что нужно сделать - это проверить настройки minicom. Если модем ответил "ОК", можно попробовать позвонить провайдеру:</para>
                <para><code>ATDP 554554</code> - для пульсового набора</para>
                <para>или</para>
                <para><code>ATDT 554554</code> - для тонового набора</para>
                <para>если модемы соединились и на экране появилось приглашение ввести логин или посыпался мусор в виде фигурных скобок (<code>{{{{{{</code>), можете себя поздравить и переходить к настройке програмного обеспечения, модем у вас работает. </para>
            </section>
        </section>
        <section>
            <info>
                <title>Настройка программного обеспечения</title>
            </info>
            <section>
                <info>
                    <title>Включение поддержки PPP в ядре</title>
                </info>
                <para>в ядре должны быть включены опции отвечающие за ppp:</para>
                <example>
                    <title>Конфигурация ядра Linux: Установка пакетов </title>
                    <screen>Device Drivers--------->
  Networking support--------->
     &lt;*>PPP (point-to-point protocol) support
     &lt;*>PPP support for async serial ports
     &lt;*>PPP Deflate compression
     &lt;*>PPP BSD compression</screen>
                </example>
            </section>
            <section>
                <info>
                    <title>Установка необходимых пакетов</title>
                </info>
                <para>во-первых, нужно установить пакет который реализует поддержку протокола точка-точка (point-to-point protocol) </para>
                <screen><prompt>#</prompt> <userinput>emerge ppp</userinput></screen>
                <para>во-вторых, нужна звонилка или скрипт для автоматизирования процеса установления соединения. </para>
                <para><emphasis role="italic">Обзор звонилок и примеры скриптов смотри ниже...</emphasis></para>
            </section>
            <section>
                <info>
                    <title>Настройка соединения с помощью chat-script</title>
                </info>
                <para>Прежде чем писать скрипт, необходимо настроить pppd:</para>
                <para>в <filename>/etc/ppp/pap-secrets</filename> пропишем свои <replaceable>Логин</replaceable>/<replaceable>Пароль</replaceable></para>
                <example>
                    <title><filename>/etc/ppp/pap-secrets</filename></title>
                    <programlisting><replaceable>login</replaceable> * <replaceable>password</replaceable> *</programlisting>
                </example>
                <para>где <replaceable>login</replaceable> и <replaceable>password</replaceable> выданые Вашим провайдером Вам логин и пароль соответственно... </para>
                <para>в <filename>/etc/ppp/options</filename> пропишем: </para>
                <example>
                    <title><filename>/etc/ppp/options</filename></title>
                    <programlisting>nodetach
defaultroute
lock
crtscts</programlisting>
                </example>
                <para>в <filename>/etc/resolv.conf</filename> прописываем один или несколько ip-адресов DNS серверов (спросить у провайдера адрес его сервера) </para>
                <example>
                    <title><filename>/etc/resolv.conf</filename></title>
                    <programlisting>nameserver <replaceable>xx.xx.xx.xx</replaceable></programlisting>
                </example>
                <para><replaceable>xx.xx.xx.xx</replaceable> - заменить на ip-адресс DNS сервера </para>
                <para>В каталоге <filename>/usr/share/doc/ppp-*/scripts</filename> лежат примеры скриптов, нам нужны:</para>
                <screen>ppp-on
ppp-off
ppp-on-dialer</screen>
                <para>подправляем в них логин, номер телефона, пароль...и вуаля...ppp-on поднимает соединение, ppp-off разрывает его, а ppp-on-dialer -воспомогательный скрипт для осуществления дозвона. </para>
                <para>замечу только что для тонового набора используется AT-команда ATDT, а для пульсового - ATDP. </para>
            </section>
            <section>
                <info>
                    <title>Обзор звонилок</title>
                </info>
                <para>Хорошая звонилка избавит Вас от процеса написания скриптов, вникания в опции pppd, и сделает настройку соединения довольно тривиальной</para>
            </section>
            <section>
                <info>
                    <title>chestnut-dialer</title>
                </info>
                <para>Замечательная звонилка которая к сожалению не поставляется в стандартных портах gentoo. ebuild можна взять <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://bugs.gentoo.org/show_bug.cgi?id=123820">здесь</link>
                </para>
                <para>Из плюсов </para>
                <itemizedlist>
                    <listitem>
                        <para>Настройка тривиальна </para>
                    </listitem>
                    <listitem>
                        <para>Умеет работать в консоли </para>
                    </listitem>
                    <listitem>
                        <para>Умеет работать в GUI (имеет GTK+ и Qt интерфейсы) </para>
                    </listitem>
                    <listitem>
                        <para>Умеет call back </para>
                    </listitem>
                    <listitem>
                        <para>Нетребовательна к ресурсам </para>
                    </listitem>
                    <listitem>
                        <para>"Местного разлива" - можно пообщаться с автором на родном языке, что для многих немаловажно. </para>
                    </listitem>
                </itemizedlist>
                <para>Из минусов </para>
                <itemizedlist>
                    <listitem>
                        <para>Не входит в официальное дерево портов </para>
                    </listitem>
                </itemizedlist>
            </section>
        </section>
        <section>
            <info>
                <title>Настройка Call back</title>
            </info>
            <para>pppd должен быть собран с поддержкой CALLBACK. В gentoo это делается по умолчанию, так что вам нужно просто собрать pppd штатными средствами. </para>
            <para>Самый простой скрипт для CALLBACK был обнаружен в <filename>/usr/doc/ppp-2.4.2/README.cbcp</filename>:</para>
            <programlisting>#!/bin/sh
pppd debug nodetach /dev/modem 115200 crtscts modem \
callback <replaceable>СВОЙ_НОМЕР</replaceable> name <replaceable>ЛОГИН</replaceable> \
connect 'chat -v "" atz OK atdt<replaceable>НОМЕР_ПРОВАЙДЕРА CONNECT</replaceable> "~--"'
sleep 1
pppd debug nodetach /dev/modem 115200 crtscts modem \
name <replaceable>ЛОГИН</replaceable> defaultroute \
connect 'chat -v RING ATA CONNECT "\c"'</programlisting>
            <para><replaceable>ЛОГИН</replaceable> должен соответствовать записи в <filename>/etc/ppp/chap-secrets</filename> (<filename>/etc/ppp/pap-secrets</filename>). В <filename>/etc/resolv.conf</filename> нужно прописать адрес DNS-сервера (можно добавить опцию usepeerdns в <filename>/etc/ppp/options</filename> для получения списка DNS серверов от провайдера). </para>
            <para>Также можно использовать kppp или chestnut-dialer для установки callback соединения. Настройки их достаточно тривиальны. </para>
            <para>Самым сложным может оказаться правильно подобрать строку инициализации для модема. Рекомендуют отключить CallerID. Приведу несколько строк инициализации для примера, но лучше берите документацию от модема (часто идет только на сидироме хотя иногда бывает и в бумажном виде), смотрите что каждая из AT комманд означает и экспериментируйте. </para>
            <itemizedlist>
                <listitem>
                    <para>Для модемов Lucent: </para>
                    <programlisting>ats0=1s38=0s37=17-v90=0
ats0=1s38=0s37=17-v90=0+vcid=0</programlisting>
                    <para>значение регистра s37 можна понижать до 14 </para>
                </listitem>
                <listitem>
                    <para>Для модемов GVC Vector K2D: </para>
                    <programlisting>ATS0=1+VCID=0&amp;U1</programlisting>
                </listitem>
            </itemizedlist>
            <para>Я лично подобрав подходящую строку инициализации, сохранил ее прямо в профиле модема... </para>
        </section>
    </section>
    <section>
        <info>
            <title>Настройка выхода через GPRS</title>
        </info>
        <para>Если вы подключаетесь через GPRS с помощью звонилки (kppp, chestnut-dialer), может быть важным использование опции pppd - noipdefault !!! </para>
        <section>
            <info>
                <title>Требуемая аппаратура</title>
            </info>
            <para>Для соединения по GPRS потребуется следующее: </para>
            <orderedlist>
                <listitem>
                    <para>Мобильный телефон, поддерживающий технологию GPRS </para>
                </listitem>
                <listitem>
                    <para>Кабель COM или USB для подключения к компьютеру ("data-кабель") либо IrDA-интерфейс. </para>
                </listitem>
            </orderedlist>
        </section>
        <section>
            <info>
                <title>Подключение с помощью USB-кабеля</title>
            </info>
            <para>Убедитесь, что в конфигурационном файле Вашего ядра присутствуют следующие опции: </para>
            <screen>"Device Drivers" >>
  [*]"Networking support" >>
    [*] "Network device support"
    &lt;M> "PPP (point-to-point protocol) support"
    &lt;M> "PPP support for async serial ports"
    &lt;M> "PPP support for sync tty ports"
    &lt;M> "PPP Deflate compression"
    &lt;M> "PPP BSD-Compress compression"</screen>
            <para>Для data-кабелей на основе микросхем Profilic 2303 (используются для подключения большинства телефонов, в том числе Siemens, Motorola, Nokia и др.) проверьте наличие: </para>
            <screen>  "USB support" >>
    "USB Serial Converter support" >>
      &lt;M> "USB Prolific 2303 Single Port Serial Driver"</screen>
            <para>После компиляции ядра проверьте модуль: </para>
            <screen><prompt>#</prompt> <userinput>modprobe pl2303</userinput></screen>
            <para>Теперь кабель представлен в системе как устройство <filename>/dev/usb/tts/0</filename> (возможно <filename>/dev/ttyUSB0</filename>), которое может быть использовано в качестве обычного модема. </para>
            <para>Для телефонов Motorola, которые подключаются кабелем mini-USB (например С380,С390) достаточно включить </para>
            <screen>   "USB support" >>
     &lt;*>"USB Modem (CDC ADCM)support"</screen>
            <para>устройство будет называться <filename>/dev/ttyACM0</filename>.</para>
        </section>
        <section>
            <info>
                <title>Подключение с помощью COM-кабеля</title>
            </info>
            <para>Тут все просто, "втыкаем" и используем...как любой модем на последовательном порту. </para>
        </section>
        <section>
            <info>
                <title>Подключение через Bluetooth</title>
            </info>
            <para>Предполагается что вы уже настроили соединение телефона с компьютером через bluetooth, например по этой статье :<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ru.gentoo-wiki.com/Работа_с_мобильными_телефонами_через_bluetooth">Работа с мобильными телефонами через bluetooth</link>. Итак устройства сопряжены. Теперь нам необходимо подключить телефон как модем. Для этого мы выполним привязку bluetooth-сервиса 1(то есть Dial-Up) к устройству /dev/rfcomm0.Начнем по порядку. </para>
            <orderedlist>
                <listitem>
                    <para>Поищем телефон </para>
                    <screen><prompt>#</prompt> <userinput>hcitool scan</userinput>
Scanning ...
       00:60:57:D5:3B:BE       Gtbear</screen>
                </listitem>
                <listitem>
                    <para>Подключим его к rfcomm0 </para>
                    <screen><prompt>#</prompt> <userinput>rfcomm bind 0 00:60:57:D5:3B:BE 1</userinput></screen>
                    <para>Этой командой мы подключили в rfcomm0 канал 1. Теперь телефон готов к работе. Осталось настроить соединения в конфигах pppd. </para>
                </listitem>
                <listitem>
                    <para>Создадим файл <filename>/etc/ppp/peers/gprs</filename>. В него запишем следующее: </para>
                    <programlisting>lcp-echo-failure 0
lcp-echo-interval 0
/dev/rfcomm0
connect /etc/ppp/peers/suct-connect # Это скрипт соединения,такое имя выбрано в честь моего оператора:
115200                              # Южно-Уральский Сотовый Телефон :)
crtscts
local
ipcp-accept-local
noauth
usepeerdns
user suct
defaultroute
noipdefault</programlisting>
                </listitem>
                <listitem>
                    <para>Теперь сделаем скрипт соединения:</para>
                    <programlisting>#!/bin/bash
exec chat -vS  \
'' \rAT \
TIMEOUT 12 \
OK ATH \
OK ATE1 \
OK 'AT+CGDCONT=1,"IP","internet.usi.ru"' \
OK ATD*99***1# \
TIMEOUT 22 \
SAY "\nWaiting for connect...\n" \
CONNECT "" \
SAY "\nGPRS connected.Enjoy.."</programlisting>
                </listitem>
                <listitem>
                    <para>В принципе все готово. Для запуска соединения можно использовать команду pppd call gprs nodetach </para>
                </listitem>
            </orderedlist>
        </section>
        <section>
            <info>
                <title>Подключение через IrDA</title>
            </info>
            <para>Пакеты: </para>
            <screen><prompt>#</prompt> <userinput>emerge irda-utils</userinput></screen>
            <example>
                <title>Конфигурация ядра Linux: Ядро 2.6 </title>
                <screen>Device Drivers --->
[*] Networking support
  &lt;*> IrDA (infrared) subsystem support --->
  &lt;*> IrCOMM protocol
  Infrared-port device drivers --->
    &lt;*> IrDA USB dongles
    &lt;*> SigmaTel STIr4200 bridge (EXPERIMENTAL)</screen>
            </example>
            <para>Когда ядро будет готово можно запускать команду: </para>
            <screen><prompt>#</prompt> <userinput>irattach irda0 -s</userinput></screen>
            <para>Теперь если поднести телефон к инфракрасному порту он должен определиться... Дальше можно поднимать ppp как для обычного модема</para>
        </section>
    </section>
    <section>
        <info>
            <title>Настройка выхода через CDMA (SKYLINK)</title>
        </info>
        <section>
            <info>
                <title>Подключение аппаратуры</title>
            </info>
            <orderedlist>
                <listitem>
                    <para>
                        <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://ru.gentoo-wiki.com/Работа_с_модемом_AnyDATA_ADU-E100A_%28SKYLINK%29">Модем AnyDATA ADU-E100A</link>
                    </para>
                </listitem>
            </orderedlist>
        </section>
        <section>
            <info>
                <title>Настройка программного обеспечения</title>
            </info>
            <orderedlist>
                <listitem>
                    <para>Устанавливаем пакет который реализует поддержку протокола точка-точка (point-to-point protocol) </para>
                    <screen># emerge ppp </screen>
                </listitem>
                <listitem>
                    <para>Редактируем файл <filename>/etc/ppp/chap-secrets</filename>
                    </para>
                    <example>
                        <title><filename>/etc/ppp/chap-secrets</filename></title>
                        <programlisting># Secrets for authentication using CHAP
# client server secret IPaddresses
"mobile" * "internet" *</programlisting>
                    </example>
                </listitem>
                <listitem>
                    <para>Создаем файл <filename>/etc/ppp/peers/cdma</filename></para>
                    <example>
                        <title><filename>/etc/ppp/peers/cdma</filename></title>
                        <programlisting>debug
/dev/ttyUSB0
921600
noipdefault
defaultroute
ipcp-accept-local
lcp-echo-interval 60
lcp-echo-failure 5
usepeerdns
nopcomp
noauth
noaccomp
nodetach
user "mobile"
connect "/usr/sbin/chat -s -S -V -t 5 -f /etc/ppp/cdma.chat"</programlisting>
                    </example>
                </listitem>
                <listitem>
                    <para>Создаем файл <filename>/etc/ppp/cdma.chat</filename></para>
                    <example>
                        <title><filename>/etc/ppp/cdma.chat</filename></title>
                        <programlisting>'' '' # "Это не кавычки, а два знака, который на клавиатуре слева от единички
'' 'ATZ' # "Это не кавычки, а два знака, который на клавиатуре слева от единички
'OK' 'ATI'
'OK' 'ATDT#777'
'CONNECT' 'ATO' </programlisting>
                    </example>
                </listitem>
                <listitem>
                    <para>Пробуем </para>
                    <screen><prompt>#</prompt> <userinput>pon cdma</userinput></screen>
                </listitem>
            </orderedlist>
        </section>
    </section>
</article>
