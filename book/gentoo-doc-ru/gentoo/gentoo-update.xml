<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbookxi.rng" type="xml"?>
<article xmlns="http://docbook.org/ns/docbook"
        xmlns:xi="http://www.w3.org/2001/XInclude"
        xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
    <info><title>Обновление Gentoo Linux</title></info>
        <para/><section><info><title>Руководство по обновлению Gentoo</title></info>
            <para/>
            <para>Ссылка на оригинал:  <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.gentoo.org/doc/ru/gentoo-upgrading.xml">http://www.gentoo.org/doc/en/gentoo-upgrading.xml</link>
            </para>
            <para>С версии: 1.2</para>
            <para>Перевод:  <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="mailto:vnp@bayarea.net">vnp</link>, <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="mailto:mike.spacer">Михаил Ярмиш</link>, <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="mailto:achumakov@gentoo.org">Алексей Чумаков</link>, <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="mailto:JohnBat26@gmail.com?subject=Обновление%20Gentoo">Батогов Е.В, a.k.a JohnBat26</link> </para>
            <para>Примечание: Из оригинала включён только самый актуальный материал !</para><section><info><title>1. Gentoo и обновления</title></info>
                <para/>
                <para>Философия</para>
                <para/>
                <para>Здесь, на земле Gentoo, обновление понимается совсем не так, как во всем остальном мире Linux. Вы, вероятно, уже знаете, что в наших дистрибутивах мы никогда не следовали «классическому» способу обновления программ: дождаться нового релиза, скачать его, прожечь, засунуть диск в дисковод и, наконец, следовать установочным инструкциям. </para>
                <para>Вы знаете (вы же не зря выбрали Gentoo), как такой процесс раздражает опытного пользователя, стремящегося всегда быть на переднем крае. Учитывая популярность и распространенность инструментов типа apt или apt-rpm, облегчающих быстрые и частые обновления, мы полагаем, что и опытные пользователи других дистрибутивов испытывают те же чувства. Однако ни один дистрибутив не приспособлен для удовлетворения нужд требовательных пользователей лучше Gentoo, поскольку Gentoo с самого начала строился на идее быстрых последовательных обновлений. </para>
                <para>В идеале, вы устанавливаете систему однажды, и более никогда не беспокоитесь о выпусках: просто следуйте инструкциям из введения в Portage в настольной книге Gentoo, где описывается, как поддерживать актуальность системы. Хотя обычно такого подхода достаточно, иногда в ядро системы вносятся изменения, требующее установки вручную. </para>
                <para/>
                <para>Выпуски и профили</para>
                <para/>
                <para>О процессе выпуска версий Gentoo постоянно задают вопрос: «Зачем нужно часто делать новые выпуски, если они не предназначены для обновления программ у пользователей?". Тому есть ряд причин: </para>
                <para>Новый выпуск — это новые исправленные и дополненные установочные диски. </para>
                <para>Новый выпуск несет обновленный набор пакетов GRP, так что пользователи, избирающие «быстрый способ» установки (stage3 + заранее скомпилированные пакеты), получают не устаревшую систему. </para>
                <para>Наконец, в новых выпусках время от времени реализуются функции, несовместимые с предыдущими выпусками. </para>
                <para>Если в выпуск входят возможности, несовместимые с предыдущими, или содержится набор фундаментальных пакетов и установок, сильно меняющих поведение системы, мы говорим, что он задает новый профиль. </para>
                <para/>
                <para>Профиль — это набор конфигурационных файлов, хранимый в подкаталоге /usr/portage/profiles, описывающий сценарии ebuild системных пакетов, флаги использования (USE) по умолчанию, отображение виртуальных пакетов по умолчанию, а также архитектуру, на которой запускается система. </para>
                <para/>
                <para>Используемый профиль определяется символьной ссылкой /etc/make.profile, которая указывает на подкаталог в /usr/portage/profiles, содержащий файлы профиля. К примеру, профиль x86 2007.0 по умолчанию находится в /usr/portage/profiles/default-linux/x86/2007.0. Файлы в родительских каталогах также входят в состав профиля (и, таким образом, совместно используются различными подпрофилями). Поэтому мы называем такие профили каскадными профилями. </para>
                <para>Профили, устаревающие с появлением новых, хранятся в /usr/portage/profiles наравне с актуальными, но помечены как как нежелательные для использования. Для этого в каталог профиля помещается файл deprecated. Файл содержит имя профиля, на который рекомендуется обновиться. Portage использует эту информацию для автоматического предупреждения о необходимости перехода на новый профиль. </para>
                <para>Существуют различные причины для создания нового профиля: выпуск новых несовместимых версий базовых пакетов (таких, как baselayout, gcc, или glibc), изменения в USE-флагах по умолчанию или отображении виртуальных пакетов, или, возможно, серьезные системные изменения. </para>
                <para/></section><section><info><title>2. Гонка за новыми выпусками</title></info>
                    <para/>
                    <para>Выпуски без изменений в профиле</para>
                    <para/>
                    <para>Если объявлен новый выпуск Gentoo, в котором не появился новый профиль, то твердо можно притвориться, что вы его не заметили :). </para>
                    <para>Ваша система будет в точности соответствовать вновь установленной с нового выпуска, если вы обновите установленные пакеты согласно описанию из Настольной книги Gentoo. </para>
                    <para/>
                    <para>Выпуски с изменениями в профиле</para>
                    <para>Если в выпуске появился новый профиль (как, например, в 2007.0 для x86), у вас есть возможность на него перейти. </para>
                    <para>Естественно, вы не обязаны это делать, и можете продолжать пользоваться старым профилем, просто обновляя свои пакеты, как описано в Настольной книге Gentoo. </para>
                    <para>Однако, Gentoo крайне рекомендует обновлять профиль, если он объявляется нежелательным для использования. Когда такое происходит, это означает, что разработчики больше не планируют его поддерживать. В приведенной ниже таблице можно быстро уточнить, какие профили поддерживаются в данный момент. </para>
                    <para>Переход на новый профиль придется осуществлять вручную. Необходимые действия могут сильно отличаться от выпуска к выпуску, в зависимости от глубины изменений, привносимых в новом профиле. </para>
                    <para>В простейшем случае, вам просто потребуется изменить символьную ссылку /etc/make.profile, а в худшем — придется перекомпилировать всю систему, тем временем изображая танец вуду. Процесс перехода обычно описывается в замечаниях к выпуску. Кроме того, есть инструкции в конце данного руководства. </para>
                    <para/>
                    <para>Поддерживаемые профили</para>
                    <para>Вы можете увидеть список профилей на Вашей архитектуре, официально поддерживаемой Gentoo когда установите утилиту eselect (emerge eselect) и затем выполните следующую команду:</para>
                    <para>Листинг 2.1 Просмотр поддерживаемых профилей</para>
                    <para># eselect profile list</para>
                    <para/></section><section><info><title>3. Инструкции по обновлению профилей</title></info>
                        <para/>
                        <para>Общие инструкции.</para>
                        <informaltable frame="all">
                            <tgroup cols="1"><tbody>
                                <row>
                                    <entry>
                                        <para>Важно:  Удостоверьтесь в том, что Ваши портэжи обновлены перед выполнением любых изменений с профилями !</para>
                                    </entry>
                                </row></tbody></tgroup>
                        </informaltable>
                        <para/>
                        <para>Первое, выполните emerge eselect. Утилита eselect  позволяет Вам просматривать и выбирать профили без необходимости создания или удаления символических ссылок вручную.</para>
                        <para/>
                        <para>Листинг 3.1: Выбор профиля с помощью утилиты eselect</para>
                        <para>(Просмотр доступных профилей)</para>
                        <para># eselect profile list</para>
                        <para>(Выберите номер Вашего желаемого профиля из списка)</para>
                        <para># eselect profile set &lt;номер профиля&gt;</para>
                        <para/>
                        <para>Если Вы предпочитаете изменять профили вручную, тогда просто сделайте следующее:</para>
                        <para/>
                        <para/>
                        <para>Листинг 3.2  Изменение профилей вручную.</para>
                        <para># rm /etc/make.profile</para>
                        <para># ln -s ../usr/portage/profiles/&lt;выбранный профиль&gt; /etc/make.profile</para>
                        <para/>
                        <informaltable frame="all">
                            <tgroup cols="1"><tbody>
                                <row>
                                    <entry>
                                        <para>Примечание: Для большинства архитектур существуют два типа подпрофилей: desktop и server. Внимательно изучите эти профили, так как они могут удовлетворять Вашим нуждам лучше, чем чрезвычайно минимальные профили по умолчанию.</para>
                                    </entry>
                                </row></tbody></tgroup>
                        </informaltable>
                        <para/>
                        <para>Обновление до 2007.0 или 2006.1</para>
                        <para>Если Вы намереваетесь обновиться до уровня этих профилей, то Вам следовало бы знать, что  они ожидают что по умолчанию в системе установлена локаль Unicode. Или более точно, должна быть определена  строка UNICODE="yes"  в файле /etc/rc.conf.  Для этоо Вы должны создать Unicode локаль для Вашей системы. Пожалуйста, прочитайте UTF-8 guide чтобы узнать как создать правильную локаль.</para>
                        <para>Альтернативно, если Вы не желаете устанавливать локаль, тогда Вы можете определить UNICODE="no" в файле  /etc/rc.conf. И переустановить (re-emerge) пакет  baselayout  (или ждите следующего обновления этого пакета) с USE флагом: -unicode. Вы можете установить -unicode только для baselayout или Вы  можете установить его глобально для всех пакетов, добавив Вашу переменную USE в файл </para>
                        <para>/etc/make.conf.</para>
                        <para>Листинг 3.3 Опционально: удаление поддержки Unicode.</para>
                        <para>(Для удаления поддержки Unicode только для baselayout)</para>
                        <para># echo "sys-apps/baselayout -unicode" &gt;&gt; /etc/portage/package.use</para>
                        <para># emerge -a baselayout</para>
                        <para/>
                        <para>(Для удаления поддержки Unicode для всей системы)</para>
                        <para># nano -w /etc/make.conf</para>
                        <para>USE="-unicode"</para>
                        <para># emerge -a baselayout</para>
                        <para/>
                        <para/>
                        <informaltable frame="all">
                            <tgroup cols="1"><tbody>
                                <row>
                                    <entry>
                                        <para>Примечание:  Если Вы обновляетесь до 2007.0 на архитектуре SPARC, тогда вы должны следовать  <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://www.gentoo.org/doc/en/gcc-upgrading.xml">GCC Upgrading Guide</link>
                                        </para>
                                    </entry>
                                </row></tbody></tgroup>
                        </informaltable>
                        <para/></section></section>
</article>